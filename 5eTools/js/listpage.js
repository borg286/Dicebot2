"use strict";class ListPage{constructor(a){this._urlData=a.urlData,this._urlFluff=a.urlFluff,this._filters=a.filters,this._filterSource=a.filterSource,this._listValueNames=a.listValueNames,this._listClass=a.listClass,this._sublistValueNames=a.sublistValueNames,this._sublistClass=a.sublistClass,this._dataProp=a.dataProp,this._renderer=Renderer.get(),this._list=null,this._filterBox=null,this._dataList=[],this._ixData=0}async pOnLoad(){await ExcludeUtil.pInitialise(),SortUtil.initHandleFilterButtonClicks();const a=await DataUtil.loadJSON(this._urlData);this._list=ListUtil.search({valueNames:this._listValueNames,listClass:this._listClass}),this._filterBox=await pInitFilterBox({filters:this._filters});const b=$(`.lst__wrp-search-visible`);this._list.on("updated",()=>{b.html(`${this._list.visibleItems.length}/${this._list.items.length}`)}),$(this._filterBox).on(FilterBox.EVNT_VALCHANGE,this.handleFilterChange.bind(this)),ListUtil.initSublist({valueNames:this._sublistValueNames,listClass:this._sublistClass,getSublistRow:this.getSublistItem.bind(this)}),ListUtil.initGenericPinnable(),this._addData(a),BrewUtil.bind({filterBox:this._filterBox,sourceFilter:this._filterSource,list:this._list,pHandleBrew:async a=>this._addData(a)});try{const a=await BrewUtil.pAddBrewData();await this._pHandleBrew(a),await BrewUtil.pAddLocalBrewData()}catch(a){BrewUtil.pPurgeBrew(a)}BrewUtil.makeBrewButton("manage-brew"),await ListUtil.pLoadState(),RollerUtil.addListRollButton(),ListUtil.addListShowHide(),window.loadHash=this.doLoadHash.bind(this),window.loadSubHash=this.doLoadSubHash.bind(this),History.init(!0),ExcludeUtil.checkShowAllExcluded(this._dataList,$(`#pagecontent`))}async _pHandleBrew(a){this._addData(a)}_addData(a){if(!a[this._dataProp]||!a[this._dataProp].length)return;this._dataList=this._dataList.concat(a[this._dataProp]);const b=$(`ul.${this._listClass}`);let c="";for(;this._ixData<this._dataList.length;this._ixData++){const a=this._dataList[this._ixData];ExcludeUtil.isExcluded(a.name,this._dataProp,a.source)||(c+=this.getListItem(a,this._ixData))}const d=ListUtil.getSearchTermAndReset(this._list);b.append(c),this._list.reIndex(),d&&this._list.search(d),this._list.sort("name"),this._filterBox.render(),this.handleFilterChange(),ListUtil.setOptions({itemList:this._dataList,primaryLists:[this._list]}),ListUtil.bindPinButton(),Renderer.hover.bindPopoutButton(this._dataList),UrlUtil.bindLinkExportButton(this._filterBox),ListUtil.bindDownloadButton(),ListUtil.bindUploadButton()}getListItem(){throw new Error(`Unimplemented!`)}handleFilterChange(){throw new Error(`Unimplemented!`)}getSublistItem(){throw new Error(`Unimplemented!`)}doLoadHash(){throw new Error(`Unimplemented!`)}doLoadSubHash(){throw new Error(`Unimplemented!`)}}